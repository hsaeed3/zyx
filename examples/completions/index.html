
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../getting-started/">
      
      
        <link rel="next" href="../memory/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>Global LLM Completion Function - zyx</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.35f28582.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=DM+Sans:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"DM Sans";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Global LLM Completion Function - zyx" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="./assets/images/social/examples/completions.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="None" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Global LLM Completion Function - zyx" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="./assets/images/social/examples/completions.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="ivory" data-md-color-accent="slate">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#generating-completions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="zyx" class="md-header__button md-logo" aria-label="zyx" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11 15H6l7-14v8h5l-7 14z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            zyx
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Global LLM Completion Function
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="ivory" data-md-color-accent="slate"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="light" data-md-color-primary="ivory" data-md-color-accent="slate"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/hsaeed3/zyx" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    zyx
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="zyx" class="md-nav__button md-logo" aria-label="zyx" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11 15H6l7-14v8h5l-7 14z"/></svg>

    </a>
    zyx
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hsaeed3/zyx" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    zyx
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    zyx
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Global LLM Completion Function
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Global LLM Completion Function
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#standard-completion" class="md-nav__link">
    <span class="md-ellipsis">
      Standard Completion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instructor-output" class="md-nav__link">
    <span class="md-ellipsis">
      Instructor Output
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tool-calling-execution" class="md-nav__link">
    <span class="md-ellipsis">
      Tool Calling &amp; Execution
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prompt-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Prompt Optimization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-reference" class="md-nav__link">
    <span class="md-ellipsis">
      API Reference
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zyx._client.completion.completion" class="md-nav__link">
    <span class="md-ellipsis">
      completion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../memory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Memory (Rag)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Agents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multimodal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multimodal Generations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    LLM Powered Functions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            LLM Powered Functions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llm/code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generative Code Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llm/nlp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NLP Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llm/prompts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create Optimized System Prompts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llm/reasoning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reasoning Based Implemenations (From Research Papers)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="generating-completions">Generating Completions</h1>
<p>The primary module of zyx, is the universal <code>.completion()</code> function. This module is an extensive wrapper around the <code>litellm .completion()</code> function, as well as the Instructor library. </br></p>
<p>The <code>.completion()</code> function is capable of</p>
<ul>
<li><strong>Generations with any LiteLLM compatible model</strong><ul>
<li>Ollama, OpenAI, Anthropic, Groq, Mistral, and more!</li>
</ul>
</li>
<li><strong>Direct Instructor Pydantc structured outputs</strong></li>
<li><strong>Tool calling &amp; execution support. (Get a tool interpretation with one function)</strong><ul>
<li>zyx provides a few prebuilt tools out of the box</li>
<li>Can take in a list of <strong>Python functions</strong>, <strong>OpenAI dictionaries</strong>, or <strong>Pydantic models</strong> as tools!</li>
<li>Automatic tool execution if a tool is called through the <code>run_tools</code> parameter</li>
</ul>
</li>
<li><strong>Streaming</strong></li>
<li><strong>New</strong> Vision support <ul>
<li>Pass in a list of urls</li>
<li>Currently uses multi shot prompting if a response model or tools were also passed.</li>
</ul>
</li>
<li><strong>New</strong> Prompt optimization <ul>
<li>Creates or optimizes a task tuned system prompt using either the <em>COSTAR</em> or <em>TIDD-EC</em> frameworks automatically.</li>
</ul>
</li>
</ul>
<h2 id="standard-completion">Standard Completion</h2>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Simplest Way to Generate</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="c1"># Defaults to &quot;gpt-4o-mini&quot; if no model is provided</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span> <span class="nn">zyx</span> <span class="kn">import</span> <span class="n">completion</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">response</span> <span class="o">=</span> <span class="n">completion</span><span class="p">(</span><span class="s2">&quot;Hi, how are you?&quot;</span><span class="p">)</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="c1"># Returns a standard OpenAI style response object</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Obviously takes in a normal list of messages as well</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">response</span> <span class="o">=</span> <span class="n">completion</span><span class="p">([</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;You are a helpful assistant&quot;</span><span class="p">},</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>    <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Hi, how are you?&quot;</span><span class="p">}</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="p">])</span>
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># OUTPUT</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>Hello!<span class="w"> </span>I<span class="s1">&#39;m just a program, but I&#39;</span>m<span class="w"> </span>here<span class="w"> </span>and<span class="w"> </span>ready<span class="w"> </span>to<span class="w"> </span><span class="nb">help</span><span class="w"> </span>you.<span class="w"> </span>How<span class="w"> </span>can<span class="w"> </span>I<span class="w"> </span>assist<span class="w"> </span>you<span class="w"> </span>today?
</span></code></pre></div>
<h2 id="instructor-output">Instructor Output</h2>
<p>Generate a Pydantic structured output using the Instructor library.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">import</span> <span class="nn">zyx</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="c1"># We can pass in a system prompt to change the behavior of the assistant</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="n">response</span> <span class="o">=</span> <span class="n">zyx</span><span class="o">.</span><span class="n">completion</span><span class="p">(</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>    <span class="s2">&quot;Create a mock person&quot;</span><span class="p">,</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>    <span class="n">response_model</span> <span class="o">=</span> <span class="n">Person</span><span class="p">,</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>    <span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;md_json&quot;</span> <span class="c1"># Change instructor parsing mode with this (default is md_json)</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="p">)</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="c1"># Lets print the full response object</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Person Name: &#39;</span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;, Person Age: &#39;</span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">age</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># OUTPUT</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>Person<span class="o">(</span><span class="nv">name</span><span class="o">=</span><span class="s1">&#39;John Doe&#39;</span>,<span class="w"> </span><span class="nv">age</span><span class="o">=</span><span class="m">30</span><span class="o">)</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>Person<span class="w"> </span>Name:<span class="w"> </span><span class="s1">&#39;John Doe&#39;</span>,<span class="w"> </span>Person<span class="w"> </span>Age:<span class="w"> </span><span class="s1">&#39;30&#39;</span>
</span></code></pre></div>
<h2 id="tool-calling-execution">Tool Calling &amp; Execution</h2>
<p>Tool calling &amp; execution allows you to call a tool with one function. Supports Python functions, OpenAI dictionaries, and Pydantic models.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># Lets return a tool call</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="kn">import</span> <span class="nn">zyx</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="c1"># Lets use the prebuilt web search tool!</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="n">response</span> <span class="o">=</span> <span class="n">zyx</span><span class="o">.</span><span class="n">completion</span><span class="p">(</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>    <span class="s2">&quot;Who won the 2024 Euro Cup Final?&quot;</span><span class="p">,</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>    <span class="n">tools</span> <span class="o">=</span> <span class="p">[</span><span class="n">zyx</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">web_search</span><span class="p">],</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>    <span class="n">run_tools</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># Set to true to execute tool calls</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="p">)</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># OUTPUT</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>Spain<span class="w"> </span>won<span class="w"> </span>the<span class="w"> </span><span class="m">2024</span><span class="w"> </span>Euro<span class="w"> </span>Cup<span class="w"> </span>Final,<span class="w"> </span>defeating<span class="w"> </span>England<span class="w"> </span><span class="m">2</span>-1.<span class="w"> </span>The<span class="w"> </span>decisive<span class="w"> </span>goal<span class="w"> </span>was<span class="w"> </span>scored<span class="w"> </span>by<span class="w"> </span>substitute<span class="w"> </span>Mikel<span class="w"> </span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>Oyarzabal<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>86th<span class="w"> </span>minute.<span class="w"> </span>This<span class="w"> </span>victory<span class="w"> </span>marked<span class="w"> </span>Spain<span class="err">&#39;</span>s<span class="w"> </span>fourth<span class="w"> </span>European<span class="w"> </span>championship<span class="w"> </span>title.<span class="w"> </span>You<span class="w"> </span>can<span class="w"> </span>find<span class="w"> </span>more<span class="w"> </span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>details<span class="w"> </span>about<span class="w"> </span>the<span class="w"> </span>match<span class="w"> </span><span class="o">(</span>https://en.wikipedia.org/wiki/UEFA_Euro_2024_Final<span class="o">)</span>.
</span></code></pre></div>
<h2 id="prompt-optimization">Prompt Optimization</h2>
<p>Optimize a prompt using either the COSTAR or TIDD-EC frameworks.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># No Optimization</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="kn">from</span> <span class="nn">zyx</span> <span class="kn">import</span> <span class="n">completion</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="n">response</span> <span class="o">=</span> <span class="n">completion</span><span class="p">(</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>    <span class="s2">&quot;Write a story about a man who travels through time to save his family from a deadly disease.&quot;</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="p">)</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</span></code></pre></div>
<details closed>
<summary>Output</summary>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># OUTPUT</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>In<span class="w"> </span>the<span class="w"> </span>small<span class="w"> </span>town<span class="w"> </span>of<span class="w"> </span>Eldridge,<span class="w"> </span>nestled<span class="w"> </span>between<span class="w"> </span>rolling<span class="w"> </span>hills<span class="w"> </span>and<span class="w"> </span>shimmering<span class="w"> </span>rivers,<span class="w"> </span>lived<span class="w"> </span>Ethan<span class="w"> </span>Forrester,<span class="w"> </span>a<span class="w"> </span>mild-mannered<span class="w"> </span>librarian<span class="w"> </span>with<span class="w"> </span>an<span class="w"> </span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>extraordinary<span class="w"> </span>obsession:<span class="w"> </span><span class="nb">time</span><span class="w"> </span>travel.<span class="w"> </span>By<span class="w"> </span>day,<span class="w"> </span>he<span class="w"> </span>cataloged<span class="w"> </span>dusty<span class="w"> </span>old<span class="w"> </span>tomes<span class="w"> </span>and<span class="w"> </span>helped<span class="w"> </span>patrons<span class="w"> </span>uncover<span class="w"> </span>forgotten<span class="w"> </span>stories<span class="p">;</span><span class="w"> </span>by<span class="w"> </span>night,<span class="w"> </span>he<span class="w"> </span>scoured<span class="w"> </span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>the<span class="w"> </span>internet<span class="w"> </span>and<span class="w"> </span>ancient<span class="w"> </span>texts<span class="w"> </span><span class="k">for</span><span class="w"> </span>clues<span class="w"> </span>that<span class="w"> </span>could<span class="w"> </span>unlock<span class="w"> </span>the<span class="w"> </span>secrets<span class="w"> </span>of<span class="w"> </span>time.
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>Then<span class="w"> </span>came<span class="w"> </span>the<span class="w"> </span>news<span class="w"> </span>that<span class="w"> </span>shattered<span class="w"> </span>his<span class="w"> </span>world.<span class="w"> </span>His<span class="w"> </span>beloved<span class="w"> </span>wife,<span class="w"> </span>Clara,<span class="w"> </span>and<span class="w"> </span>their<span class="w"> </span>two<span class="w"> </span>children,<span class="w"> </span>Lucy<span class="w"> </span>and<span class="w"> </span>Sam,<span class="w"> </span>had<span class="w"> </span>contracted<span class="w"> </span>a<span class="w"> </span>mysterious<span class="w"> </span>and<span class="w"> </span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>deadly<span class="w"> </span>disease<span class="w"> </span>that<span class="w"> </span>was<span class="w"> </span>sweeping<span class="w"> </span>through<span class="w"> </span>the<span class="w"> </span>town<span class="w"> </span>like<span class="w"> </span>wildfire.<span class="w"> </span>Despite<span class="w"> </span>the<span class="w"> </span>doctors’<span class="w"> </span>best<span class="w"> </span>efforts<span class="w"> </span>and<span class="w"> </span>the<span class="w"> </span>hospital’s<span class="w"> </span>desperate<span class="w"> </span>measures,<span class="w"> </span>the<span class="w"> </span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>prognosis<span class="w"> </span>was<span class="w"> </span>grim.<span class="w"> </span>Ethan<span class="w"> </span>learned<span class="w"> </span>that<span class="w"> </span><span class="k">if</span><span class="w"> </span>he<span class="w"> </span>did<span class="w"> </span>not<span class="w"> </span>act<span class="w"> </span>fast,<span class="w"> </span>he<span class="w"> </span>would<span class="w"> </span>lose<span class="w"> </span>the<span class="w"> </span>most<span class="w"> </span>precious<span class="w"> </span>people<span class="w"> </span><span class="k">in</span><span class="w"> </span>his<span class="w"> </span>life.
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>One<span class="w"> </span>stormy<span class="w"> </span>evening,<span class="w"> </span>as<span class="w"> </span>thunder<span class="w"> </span>rumbled<span class="w"> </span>ominously<span class="w"> </span>outside,<span class="w"> </span>Ethan<span class="w"> </span>discovered<span class="w"> </span>a<span class="w"> </span>brittle<span class="w"> </span>manuscript<span class="w"> </span>hidden<span class="w"> </span>behind<span class="w"> </span>the<span class="w"> </span>row<span class="w"> </span>of<span class="w"> </span>encyclopedias.<span class="w"> </span>It<span class="w"> </span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>spoke<span class="w"> </span>of<span class="w"> </span>a<span class="w"> </span>time-traveling<span class="w"> </span>device,<span class="w"> </span>built<span class="w"> </span>by<span class="w"> </span>a<span class="w"> </span>forgotten<span class="w"> </span>inventor<span class="w"> </span>named<span class="w"> </span>Archimedes<span class="w"> </span>Blake—an<span class="w"> </span>intricate<span class="w"> </span>metal<span class="w"> </span>orb<span class="w"> </span>that<span class="w"> </span>pulsed<span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>strange<span class="w"> </span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>energy.<span class="w"> </span>The<span class="w"> </span>instructions<span class="w"> </span>were<span class="w"> </span>hazy,<span class="w"> </span>but<span class="w"> </span>Ethan<span class="w"> </span>understood<span class="w"> </span>one<span class="w"> </span>thing:<span class="w"> </span>he<span class="w"> </span>had<span class="w"> </span>to<span class="w"> </span>find<span class="w"> </span>it.
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>He<span class="w"> </span>scoured<span class="w"> </span>every<span class="w"> </span>corner<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>library<span class="w"> </span><span class="k">for</span><span class="w"> </span>weeks,<span class="w"> </span><span class="k">until</span>,<span class="w"> </span>finally,<span class="w"> </span>he<span class="w"> </span>found<span class="w"> </span>an<span class="w"> </span>ancient<span class="w"> </span>map<span class="w"> </span>hidden<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>spine<span class="w"> </span>of<span class="w"> </span>a<span class="w"> </span>long-neglected<span class="w"> </span>book.<span class="w"> </span>The<span class="w"> </span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>map<span class="w"> </span>contained<span class="w"> </span>clues<span class="w"> </span>leading<span class="w"> </span>to<span class="w"> </span>Archimedes’s<span class="w"> </span>laboratory,<span class="w"> </span>which<span class="w"> </span>lay<span class="w"> </span>abandoned<span class="w"> </span><span class="k">in</span><span class="w"> </span>a<span class="w"> </span>remote<span class="w"> </span>part<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>nearby<span class="w"> </span>woods.<span class="w"> </span>Driven<span class="w"> </span>by<span class="w"> </span>desperation,<span class="w"> </span>Ethan
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>packed<span class="w"> </span>supplies<span class="w"> </span>and<span class="w"> </span><span class="nb">set</span><span class="w"> </span>off<span class="w"> </span>into<span class="w"> </span>the<span class="w"> </span>forest<span class="w"> </span>that<span class="w"> </span>night.
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>The<span class="w"> </span>air<span class="w"> </span>was<span class="w"> </span>thick<span class="w"> </span>with<span class="w"> </span>mist<span class="w"> </span>as<span class="w"> </span>he<span class="w"> </span>crossed<span class="w"> </span>over<span class="w"> </span>fallen<span class="w"> </span>branches<span class="w"> </span>and<span class="w"> </span>brambles.<span class="w"> </span>Guided<span class="w"> </span>by<span class="w"> </span>the<span class="w"> </span>map’s<span class="w"> </span>scribbled<span class="w"> </span>notes<span class="w"> </span>and<span class="w"> </span>an<span class="w"> </span>adrenaline-fueled<span class="w"> </span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>determination,<span class="w"> </span>he<span class="w"> </span>reached<span class="w"> </span>a<span class="w"> </span>tumbledown<span class="w"> </span>cottage<span class="w"> </span>shrouded<span class="w"> </span><span class="k">in</span><span class="w"> </span>vines<span class="w"> </span>and<span class="w"> </span>shadows.<span class="w"> </span>Inside<span class="w"> </span>lay<span class="w"> </span>the<span class="w"> </span>remnants<span class="w"> </span>of<span class="w"> </span>Archimedes’s<span class="w"> </span>past—a<span class="w"> </span>jumble<span class="w"> </span>of<span class="w"> </span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a>beakers,<span class="w"> </span>gears,<span class="w"> </span>and<span class="w"> </span>sketches.<span class="w"> </span>In<span class="w"> </span>the<span class="w"> </span>center,<span class="w"> </span>on<span class="w"> </span>a<span class="w"> </span>makeshift<span class="w"> </span>table,<span class="w"> </span>rested<span class="w"> </span>the<span class="w"> </span>metal<span class="w"> </span>orb,<span class="w"> </span>its<span class="w"> </span>surface<span class="w"> </span>gleaming<span class="w"> </span>like<span class="w"> </span>a<span class="w"> </span>star<span class="w"> </span>shrouded<span class="w"> </span><span class="k">in</span><span class="w"> </span>dust.
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a>After<span class="w"> </span>hours<span class="w"> </span>of<span class="w"> </span>tinkering<span class="w"> </span>and<span class="w"> </span>curse-laden<span class="w"> </span>frustration,<span class="w"> </span>Ethan<span class="w"> </span>managed<span class="w"> </span>to<span class="w"> </span>grasp<span class="w"> </span>the<span class="w"> </span>orb<span class="w"> </span>correctly,<span class="w"> </span>recalling<span class="w"> </span>the<span class="w"> </span>few<span class="w"> </span>instructions<span class="w"> </span>he<span class="w"> </span>had<span class="w"> </span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a>deciphered.<span class="w"> </span>His<span class="w"> </span>heart<span class="w"> </span>raced<span class="w"> </span>as<span class="w"> </span>he<span class="w"> </span>envisioned<span class="w"> </span>where<span class="w"> </span>he<span class="w"> </span>needed<span class="w"> </span>to<span class="w"> </span>go:<span class="w"> </span>the<span class="w"> </span>moment<span class="w"> </span>before<span class="w"> </span>the<span class="w"> </span>disease<span class="w"> </span>had<span class="w"> </span>struck<span class="w"> </span>the<span class="w"> </span>town<span class="p">;</span><span class="w"> </span>the<span class="w"> </span>point<span class="w"> </span>where<span class="w"> </span>he<span class="w"> </span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>could<span class="w"> </span>warn<span class="w"> </span>his<span class="w"> </span>family<span class="w"> </span>and<span class="w"> </span>seek<span class="w"> </span>treatment<span class="w"> </span>before<span class="w"> </span>it<span class="w"> </span>ensnared<span class="w"> </span>them.
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a>With<span class="w"> </span>a<span class="w"> </span>deep<span class="w"> </span>breath,<span class="w"> </span>Ethan<span class="w"> </span>activated<span class="w"> </span>the<span class="w"> </span>orb.<span class="w"> </span>Blinding<span class="w"> </span>light<span class="w"> </span>enveloped<span class="w"> </span>him,<span class="w"> </span>and<span class="w"> </span>he<span class="w"> </span>felt<span class="w"> </span>a<span class="w"> </span>strange<span class="w"> </span>sensation,<span class="w"> </span>as<span class="w"> </span><span class="k">if</span><span class="w"> </span>he<span class="w"> </span>were<span class="w"> </span>being<span class="w"> </span>pulled<span class="w"> </span>apart<span class="w"> </span>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a>and<span class="w"> </span>stitched<span class="w"> </span>back<span class="w"> </span>together<span class="w"> </span>again.<span class="w"> </span>Moments<span class="w"> </span>later,<span class="w"> </span>he<span class="w"> </span>collapsed<span class="w"> </span>onto<span class="w"> </span>the<span class="w"> </span>ground—different<span class="w"> </span>leaves<span class="w"> </span>under<span class="w"> </span>him,<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>sense<span class="w"> </span>of<span class="w"> </span>calm<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>air.<span class="w"> </span>It<span class="w"> </span>
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a>was<span class="w"> </span>late<span class="w"> </span>summer,<span class="w"> </span>two<span class="w"> </span>months<span class="w"> </span>earlier.<span class="w"> </span>The<span class="w"> </span>sun<span class="w"> </span>bathed<span class="w"> </span>the<span class="w"> </span>town<span class="w"> </span>of<span class="w"> </span>Eldridge<span class="w"> </span><span class="k">in</span><span class="w"> </span>a<span class="w"> </span>warm<span class="w"> </span>glow,<span class="w"> </span>and<span class="w"> </span>he<span class="w"> </span>could<span class="w"> </span>hear<span class="w"> </span>the<span class="w"> </span>distant<span class="w"> </span>laughter<span class="w"> </span>of<span class="w"> </span>children<span class="w"> </span>
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a>playing<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>park.
</span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a>
</span><span id="__span-8-31"><a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a>Ethan<span class="err">&#39;</span>s<span class="w"> </span>heart<span class="w"> </span>swelled<span class="w"> </span>with<span class="w"> </span>hope.<span class="w"> </span>He<span class="w"> </span><span class="nb">set</span><span class="w"> </span>out<span class="w"> </span><span class="k">for</span><span class="w"> </span>home,<span class="w"> </span>each<span class="w"> </span>step<span class="w"> </span>quickening<span class="w"> </span><span class="k">in</span><span class="w"> </span>urgency.<span class="w"> </span>He<span class="w"> </span>burst<span class="w"> </span>through<span class="w"> </span>the<span class="w"> </span>front<span class="w"> </span>door,<span class="w"> </span>breathless<span class="w"> </span>and<span class="w"> </span>
</span><span id="__span-8-32"><a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a>frazzled.<span class="w"> </span>Clara<span class="w"> </span>looked<span class="w"> </span>up<span class="w"> </span>from<span class="w"> </span>the<span class="w"> </span>kitchen,<span class="w"> </span>her<span class="w"> </span>smile<span class="w"> </span>melting<span class="w"> </span>into<span class="w"> </span>confusion.
</span><span id="__span-8-33"><a id="__codelineno-8-33" name="__codelineno-8-33" href="#__codelineno-8-33"></a>
</span><span id="__span-8-34"><a id="__codelineno-8-34" name="__codelineno-8-34" href="#__codelineno-8-34"></a>“Ethan?<span class="w"> </span>You’re<span class="w"> </span>home<span class="w"> </span>early!”<span class="w"> </span>she<span class="w"> </span>exclaimed,<span class="w"> </span>wiping<span class="w"> </span>her<span class="w"> </span>hands<span class="w"> </span>on<span class="w"> </span>a<span class="w"> </span>dish<span class="w"> </span>towel.
</span><span id="__span-8-35"><a id="__codelineno-8-35" name="__codelineno-8-35" href="#__codelineno-8-35"></a>
</span><span id="__span-8-36"><a id="__codelineno-8-36" name="__codelineno-8-36" href="#__codelineno-8-36"></a>“Clara,<span class="w"> </span>we<span class="w"> </span>need<span class="w"> </span>to<span class="w"> </span>talk!<span class="w"> </span>The<span class="w"> </span>kids—Lucy<span class="w"> </span>and<span class="w"> </span>Sam—they<span class="w"> </span>need<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>checked<span class="w"> </span>by<span class="w"> </span>a<span class="w"> </span>doctor.<span class="w"> </span>There’s<span class="w"> </span>something<span class="w"> </span>terrible<span class="w"> </span>coming.”
</span><span id="__span-8-37"><a id="__codelineno-8-37" name="__codelineno-8-37" href="#__codelineno-8-37"></a>
</span><span id="__span-8-38"><a id="__codelineno-8-38" name="__codelineno-8-38" href="#__codelineno-8-38"></a>Clara<span class="w"> </span>raised<span class="w"> </span>an<span class="w"> </span>eyebrow,<span class="w"> </span>bemused<span class="w"> </span>by<span class="w"> </span>Ethan’s<span class="w"> </span>intensity,<span class="w"> </span>but<span class="w"> </span>he<span class="w"> </span>could<span class="w"> </span>see<span class="w"> </span>the<span class="w"> </span>flicker<span class="w"> </span>of<span class="w"> </span>concern<span class="w"> </span><span class="k">in</span><span class="w"> </span>her<span class="w"> </span>eyes.<span class="w"> </span>He<span class="w"> </span>explained<span class="w"> </span>everything—the<span class="w"> </span>
</span><span id="__span-8-39"><a id="__codelineno-8-39" name="__codelineno-8-39" href="#__codelineno-8-39"></a>disease,<span class="w"> </span>the<span class="w"> </span>timeline,<span class="w"> </span>the<span class="w"> </span>frantic<span class="w"> </span>search<span class="w"> </span><span class="k">for</span><span class="w"> </span>a<span class="w"> </span>cure—all<span class="w"> </span><span class="k">while</span><span class="w"> </span>Lucy<span class="w"> </span>and<span class="w"> </span>Sam<span class="w"> </span>played,<span class="w"> </span>oblivious<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>urgency.
</span><span id="__span-8-40"><a id="__codelineno-8-40" name="__codelineno-8-40" href="#__codelineno-8-40"></a>
</span><span id="__span-8-41"><a id="__codelineno-8-41" name="__codelineno-8-41" href="#__codelineno-8-41"></a>The<span class="w"> </span>following<span class="w"> </span>days<span class="w"> </span>were<span class="w"> </span>a<span class="w"> </span>whirlwind.<span class="w"> </span>Ethan<span class="w"> </span>persuaded<span class="w"> </span>Clara<span class="w"> </span>to<span class="w"> </span>take<span class="w"> </span>the<span class="w"> </span>children<span class="w"> </span><span class="k">for</span><span class="w"> </span>a<span class="w"> </span>full<span class="w"> </span>checkup<span class="w"> </span>and<span class="w"> </span>lab<span class="w"> </span>tests.<span class="w"> </span>As<span class="w"> </span>they<span class="w"> </span>waited,<span class="w"> </span>Ethan<span class="w"> </span>shared
</span><span id="__span-8-42"><a id="__codelineno-8-42" name="__codelineno-8-42" href="#__codelineno-8-42"></a>with<span class="w"> </span>Clara<span class="w"> </span>snippets<span class="w"> </span>from<span class="w"> </span>the<span class="w"> </span>future—their<span class="w"> </span>family<span class="w"> </span>struggles,<span class="w"> </span>the<span class="w"> </span>joys,<span class="w"> </span>and<span class="w"> </span>sorrows.<span class="w"> </span>He<span class="w"> </span>watched<span class="w"> </span>as<span class="w"> </span>realization<span class="w"> </span>dawned<span class="w"> </span>on<span class="w"> </span>her<span class="w"> </span>face<span class="w"> </span>about<span class="w"> </span>the<span class="w"> </span>
</span><span id="__span-8-43"><a id="__codelineno-8-43" name="__codelineno-8-43" href="#__codelineno-8-43"></a>fragility<span class="w"> </span>of<span class="w"> </span>life.<span class="w"> </span>
</span><span id="__span-8-44"><a id="__codelineno-8-44" name="__codelineno-8-44" href="#__codelineno-8-44"></a>
</span><span id="__span-8-45"><a id="__codelineno-8-45" name="__codelineno-8-45" href="#__codelineno-8-45"></a>A<span class="w"> </span>week<span class="w"> </span>later,<span class="w"> </span>the<span class="w"> </span>tests<span class="w"> </span>came<span class="w"> </span>back.<span class="w"> </span>Bit<span class="w"> </span>by<span class="w"> </span>bit,<span class="w"> </span>the<span class="w"> </span>pieces<span class="w"> </span>started<span class="w"> </span>to<span class="w"> </span>fall<span class="w"> </span>into<span class="w"> </span>place.<span class="w"> </span>With<span class="w"> </span>early<span class="w"> </span>intervention,<span class="w"> </span>the<span class="w"> </span>family<span class="w"> </span>received<span class="w"> </span>treatment<span class="w"> </span>
</span><span id="__span-8-46"><a id="__codelineno-8-46" name="__codelineno-8-46" href="#__codelineno-8-46"></a>from<span class="w"> </span>a<span class="w"> </span>specialist<span class="w"> </span>flown<span class="w"> </span><span class="k">in</span><span class="w"> </span>from<span class="w"> </span>the<span class="w"> </span>city.<span class="w"> </span>The<span class="w"> </span>miraculous<span class="w"> </span>news<span class="w"> </span>hit<span class="w"> </span>them<span class="w"> </span>like<span class="w"> </span>a<span class="w"> </span>fresh<span class="w"> </span>spring<span class="w"> </span>breeze—the<span class="w"> </span>strain<span class="w"> </span>had<span class="w"> </span>been<span class="w"> </span>captured,<span class="w"> </span>and<span class="w"> </span>a<span class="w"> </span>vaccine<span class="w"> </span>
</span><span id="__span-8-47"><a id="__codelineno-8-47" name="__codelineno-8-47" href="#__codelineno-8-47"></a>was<span class="w"> </span>developed<span class="w"> </span><span class="k">in</span><span class="w"> </span>record<span class="w"> </span>time.<span class="w"> </span>The<span class="w"> </span>disease<span class="w"> </span>had<span class="w"> </span>not<span class="w"> </span>yet<span class="w"> </span>had<span class="w"> </span>a<span class="w"> </span>chance<span class="w"> </span>to<span class="w"> </span>strike<span class="w"> </span>them<span class="w"> </span>down.<span class="w"> </span>
</span><span id="__span-8-48"><a id="__codelineno-8-48" name="__codelineno-8-48" href="#__codelineno-8-48"></a>
</span><span id="__span-8-49"><a id="__codelineno-8-49" name="__codelineno-8-49" href="#__codelineno-8-49"></a>As<span class="w"> </span>Ethan<span class="w"> </span>watched<span class="w"> </span>them<span class="w"> </span>heal<span class="w"> </span>and<span class="w"> </span>grow<span class="w"> </span>stronger,<span class="w"> </span>he<span class="w"> </span>felt<span class="w"> </span>a<span class="w"> </span>pang<span class="w"> </span>of<span class="w"> </span>bittersweet<span class="w"> </span>longing.<span class="w"> </span>He<span class="w"> </span>had<span class="w"> </span>a<span class="w"> </span>profound<span class="w"> </span>understanding<span class="w"> </span>of<span class="w"> </span>time,<span class="w"> </span>of<span class="w"> </span>its<span class="w"> </span>
</span><span id="__span-8-50"><a id="__codelineno-8-50" name="__codelineno-8-50" href="#__codelineno-8-50"></a>relentless<span class="w"> </span>march<span class="w"> </span>and<span class="w"> </span>its<span class="w"> </span>moments<span class="w"> </span>of<span class="w"> </span>beauty.<span class="w"> </span>One<span class="w"> </span>evening,<span class="w"> </span>as<span class="w"> </span>the<span class="w"> </span>sun<span class="w"> </span>dipped<span class="w"> </span>below<span class="w"> </span>the<span class="w"> </span>horizon,<span class="w"> </span>he<span class="w"> </span>returned<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>woods<span class="w"> </span>where<span class="w"> </span>the<span class="w"> </span>orb<span class="w"> </span>lay<span class="w"> </span>
</span><span id="__span-8-51"><a id="__codelineno-8-51" name="__codelineno-8-51" href="#__codelineno-8-51"></a>hidden.<span class="w"> </span>
</span><span id="__span-8-52"><a id="__codelineno-8-52" name="__codelineno-8-52" href="#__codelineno-8-52"></a>
</span><span id="__span-8-53"><a id="__codelineno-8-53" name="__codelineno-8-53" href="#__codelineno-8-53"></a>Clutching<span class="w"> </span>it<span class="w"> </span>tightly,<span class="w"> </span>he<span class="w"> </span>whispered<span class="w"> </span>a<span class="w"> </span>silent<span class="w"> </span>thanks<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>second<span class="w"> </span>chance<span class="w"> </span>before<span class="w"> </span>burying<span class="w"> </span>it<span class="w"> </span>deep<span class="w"> </span>beneath<span class="w"> </span>the<span class="w"> </span>earth.<span class="w"> </span>He<span class="w"> </span>had<span class="w"> </span>come<span class="w"> </span><span class="k">for</span><span class="w"> </span>a<span class="w"> </span>purpose,<span class="w"> </span>
</span><span id="__span-8-54"><a id="__codelineno-8-54" name="__codelineno-8-54" href="#__codelineno-8-54"></a>and<span class="w"> </span>now,<span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>family<span class="w"> </span>he<span class="w"> </span>cherished<span class="w"> </span>more<span class="w"> </span>than<span class="w"> </span>anything,<span class="w"> </span>he<span class="w"> </span>was<span class="w"> </span>ready<span class="w"> </span>to<span class="w"> </span>live<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>present.
</span><span id="__span-8-55"><a id="__codelineno-8-55" name="__codelineno-8-55" href="#__codelineno-8-55"></a>
</span><span id="__span-8-56"><a id="__codelineno-8-56" name="__codelineno-8-56" href="#__codelineno-8-56"></a>Years<span class="w"> </span>later,<span class="w"> </span>as<span class="w"> </span>he<span class="w"> </span><span class="nb">read</span><span class="w"> </span>to<span class="w"> </span>Lucy<span class="w"> </span>and<span class="w"> </span>Sam<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>sprawling<span class="w"> </span>garden<span class="w"> </span>of<span class="w"> </span>their<span class="w"> </span>home,<span class="w"> </span>Ethan<span class="w"> </span>smiled<span class="w"> </span>fondly<span class="w"> </span>at<span class="w"> </span>Clara.<span class="w"> </span>Life<span class="w"> </span>was<span class="w"> </span>fragile<span class="w"> </span>and<span class="w"> </span>precious,<span class="w"> </span>
</span><span id="__span-8-57"><a id="__codelineno-8-57" name="__codelineno-8-57" href="#__codelineno-8-57"></a>but,<span class="w"> </span>as<span class="w"> </span>he<span class="w"> </span>had<span class="w"> </span>learned,<span class="w"> </span>so<span class="w"> </span>was<span class="w"> </span>hope.<span class="w"> </span>He<span class="w"> </span>vowed<span class="w"> </span>never<span class="w"> </span>to<span class="w"> </span>forget<span class="w"> </span>the<span class="w"> </span>lessons<span class="w"> </span>of<span class="w"> </span><span class="nb">time</span><span class="w"> </span>and<span class="w"> </span>love,<span class="w"> </span>believing<span class="w"> </span>deeply<span class="w"> </span>that<span class="w"> </span>every<span class="w"> </span>moment<span class="w"> </span>shared<span class="w"> </span>was<span class="w"> </span>the<span class="w"> </span>
</span><span id="__span-8-58"><a id="__codelineno-8-58" name="__codelineno-8-58" href="#__codelineno-8-58"></a>greatest<span class="w"> </span>adventure<span class="w"> </span>of<span class="w"> </span>all.
</span></code></pre></div>

</details>

<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="kn">from</span> <span class="nn">zyx</span> <span class="kn">import</span> <span class="n">completion</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="n">response</span> <span class="o">=</span> <span class="n">completion</span><span class="p">(</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>    <span class="s2">&quot;Write a story about a man who travels through time to save his family from a deadly disease.&quot;</span><span class="p">,</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>    <span class="n">optimize</span> <span class="o">=</span> <span class="s2">&quot;costar&quot;</span> <span class="c1"># Optimize with COSTAR</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="p">)</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</span></code></pre></div>
<details closed>
<summary>Output</summary>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1"># OUTPUT</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="c1"># Chapter 1: A World in Shadows</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>In<span class="w"> </span>the<span class="w"> </span>year<span class="w"> </span><span class="m">2142</span>,<span class="w"> </span>the<span class="w"> </span>world<span class="w"> </span>had<span class="w"> </span>crumbled<span class="w"> </span>under<span class="w"> </span>the<span class="w"> </span>weight<span class="w"> </span>of<span class="w"> </span>a<span class="w"> </span>relentless<span class="w"> </span>epidemic.<span class="w"> </span>A<span class="w"> </span>once-vibrant<span class="w"> </span>society<span class="w"> </span>now<span class="w"> </span>flickered<span class="w"> </span>like<span class="w"> </span>a<span class="w"> </span>dying<span class="w"> </span>ember,<span class="w"> </span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>choked<span class="w"> </span>by<span class="w"> </span>despair<span class="w"> </span>and<span class="w"> </span>grief.<span class="w"> </span>Ethan<span class="w"> </span>was<span class="w"> </span>no<span class="w"> </span>stranger<span class="w"> </span>to<span class="w"> </span>this<span class="w"> </span>darkness<span class="p">;</span><span class="w"> </span>it<span class="w"> </span>haunted<span class="w"> </span>his<span class="w"> </span>every<span class="w"> </span>waking<span class="w"> </span>moment.<span class="w"> </span>His<span class="w"> </span>family—his<span class="w"> </span>wife<span class="w"> </span>Megan<span class="w"> </span>and<span class="w"> </span>their<span class="w"> </span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>ten-year-old<span class="w"> </span>son<span class="w"> </span>Lucas—had<span class="w"> </span>been<span class="w"> </span>caught<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>relentless<span class="w"> </span>grip<span class="w"> </span>of<span class="w"> </span>a<span class="w"> </span>disease<span class="w"> </span>that<span class="w"> </span>science<span class="w"> </span>had<span class="w"> </span>yet<span class="w"> </span>to<span class="w"> </span>understand,<span class="w"> </span><span class="nb">let</span><span class="w"> </span>alone<span class="w"> </span>cure.<span class="w"> </span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>Standing<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>crumbling<span class="w"> </span>remnants<span class="w"> </span>of<span class="w"> </span>their<span class="w"> </span>home,<span class="w"> </span>Ethan<span class="w"> </span>clutched<span class="w"> </span>a<span class="w"> </span>faded<span class="w"> </span>photograph<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>three<span class="w"> </span>of<span class="w"> </span>them—smiling<span class="w"> </span>amidst<span class="w"> </span>the<span class="w"> </span>towering<span class="w"> </span>oaks<span class="w"> </span>of<span class="w"> </span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>their<span class="w"> </span>backyard<span class="w"> </span>during<span class="w"> </span>a<span class="w"> </span>summer<span class="w"> </span>picnic,<span class="w"> </span>the<span class="w"> </span>sun<span class="w"> </span>breathing<span class="w"> </span>life<span class="w"> </span>into<span class="w"> </span>their<span class="w"> </span>laughter.<span class="w"> </span>Those<span class="w"> </span>moments<span class="w"> </span>now<span class="w"> </span>felt<span class="w"> </span>like<span class="w"> </span>whispers<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>different<span class="w"> </span>life,
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>swallowed<span class="w"> </span>by<span class="w"> </span>an<span class="w"> </span>abyss<span class="w"> </span>of<span class="w"> </span>hopelessness.<span class="w"> </span>Each<span class="w"> </span>day,<span class="w"> </span>he<span class="w"> </span>watched<span class="w"> </span>as<span class="w"> </span>the<span class="w"> </span>light<span class="w"> </span>dimmed<span class="w"> </span><span class="k">in</span><span class="w"> </span>Megan’s<span class="w"> </span>eyes<span class="w"> </span>and<span class="w"> </span>as<span class="w"> </span>Lucas<span class="w"> </span>succumbed<span class="w"> </span>to<span class="w"> </span>fits<span class="w"> </span>of<span class="w"> </span>coughing<span class="w"> </span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>that<span class="w"> </span>rattled<span class="w"> </span>his<span class="w"> </span>small<span class="w"> </span>frame.<span class="w"> </span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>Desperation<span class="w"> </span>clawed<span class="w"> </span>at<span class="w"> </span>Ethan’s<span class="w"> </span>chest,<span class="w"> </span>gnawing<span class="w"> </span>away<span class="w"> </span>at<span class="w"> </span>his<span class="w"> </span>resolve.<span class="w"> </span>But<span class="w"> </span>buried<span class="w"> </span>deep<span class="w"> </span>within<span class="w"> </span>him<span class="w"> </span>lay<span class="w"> </span>a<span class="w"> </span>flicker<span class="w"> </span>of<span class="w"> </span>an<span class="w"> </span>idea—rumors<span class="w"> </span>of<span class="w"> </span><span class="nb">time</span><span class="w"> </span>travel,<span class="w"> </span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>of<span class="w"> </span>bending<span class="w"> </span>the<span class="w"> </span>very<span class="w"> </span>fabric<span class="w"> </span>of<span class="w"> </span>reality<span class="w"> </span>to<span class="w"> </span>find<span class="w"> </span>a<span class="w"> </span>remedy<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>past.<span class="w"> </span>He<span class="w"> </span>had<span class="w"> </span>to<span class="w"> </span>try.
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="c1"># Chapter 2: The Chronosphere</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>Ethan<span class="s1">&#39;s journey began in the bowels of an ancient research facility, long abandoned yet whispered about among the few who still dared to </span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="s1">dream. There, he found tales of a machine, the Chronosphere—a device that could pierce the veil of time.</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="s1">After days of rummaging through tattered blueprints and decoding fragmented notes left behind by hopeless scientists, Ethan unearthed a </span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="s1">working prototype, a hissing contraption of gears and glowing screens that threatened to expel him into the unknown. Steeling himself, he </span>
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="s1">whispered his intentions, “I need to save my family.” </span>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a>
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="s1">With a flick of a switch, the room around him dimmed. An orchestra of energy hummed, thrumming with the promise of travel as spirals of light </span>
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a><span class="s1">enveloped him. One moment he was standing in the desolation of 2142, and the next, he was hurtling through time, the colors around him </span>
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a><span class="s1">swirling like oil on water. </span>
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a>
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a><span class="s1"># Chapter 3: The Success of the Past</span>
</span><span id="__span-10-30"><a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a>
</span><span id="__span-10-31"><a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a><span class="s1">Ethan landed in the year 1962, the air thick with the sweetness of blooming flowers and the hum of life—a stark contrast to the sterile </span>
</span><span id="__span-10-32"><a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a><span class="s1">silence of his home. The sun blazed in a way it hadn’t done in a long time. His heart raced with both exhilaration and anxiety, but he was </span>
</span><span id="__span-10-33"><a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a><span class="s1">focused—his mission was to find that elusive cure.</span>
</span><span id="__span-10-34"><a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a>
</span><span id="__span-10-35"><a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a><span class="s1">He found solace in the bustling energy of the city, absorbing the sights and sounds that felt foreign yet familiar. Guided by flickering </span>
</span><span id="__span-10-36"><a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a><span class="s1">fragments of his research, he sought out a brilliant scientist, Dr. Elizabeth Hale—a name that stood out in the annals of hope for a disease </span>
</span><span id="__span-10-37"><a id="__codelineno-10-37" name="__codelineno-10-37" href="#__codelineno-10-37"></a><span class="s1">curiously similar to the one afflicting his family.</span>
</span><span id="__span-10-38"><a id="__codelineno-10-38" name="__codelineno-10-38" href="#__codelineno-10-38"></a>
</span><span id="__span-10-39"><a id="__codelineno-10-39" name="__codelineno-10-39" href="#__codelineno-10-39"></a><span class="s1">As he approached the tall brick laboratory, he felt the weight of his desperation intensify. Would she believe him? Could she help?</span>
</span><span id="__span-10-40"><a id="__codelineno-10-40" name="__codelineno-10-40" href="#__codelineno-10-40"></a>
</span><span id="__span-10-41"><a id="__codelineno-10-41" name="__codelineno-10-41" href="#__codelineno-10-41"></a><span class="s1"># Chapter 4: Connections to History</span>
</span><span id="__span-10-42"><a id="__codelineno-10-42" name="__codelineno-10-42" href="#__codelineno-10-42"></a>
</span><span id="__span-10-43"><a id="__codelineno-10-43" name="__codelineno-10-43" href="#__codelineno-10-43"></a><span class="s1">Ethan&#39;</span>s<span class="w"> </span>heart<span class="w"> </span>pounded<span class="w"> </span>as<span class="w"> </span>he<span class="w"> </span>introduced<span class="w"> </span>himself,<span class="w"> </span>weaving<span class="w"> </span>a<span class="w"> </span>tale<span class="w"> </span>flirted<span class="w"> </span>with<span class="w"> </span>half-truths<span class="w"> </span><span class="k">while</span><span class="w"> </span>holding<span class="w"> </span>the<span class="w"> </span>fragile<span class="w"> </span>essence<span class="w"> </span>of<span class="w"> </span>faith.<span class="w"> </span>Dr.<span class="w"> </span>Hale<span class="w"> </span>
</span><span id="__span-10-44"><a id="__codelineno-10-44" name="__codelineno-10-44" href="#__codelineno-10-44"></a>was<span class="w"> </span>skeptical<span class="w"> </span>initially,<span class="w"> </span>her<span class="w"> </span>brow<span class="w"> </span>raised<span class="w"> </span><span class="k">in</span><span class="w"> </span>doubt.<span class="w"> </span>Yet,<span class="w"> </span>as<span class="w"> </span>Ethan<span class="w"> </span>shared<span class="w"> </span>his<span class="w"> </span>knowledge<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>disease—its<span class="w"> </span>symptoms,<span class="w"> </span>its<span class="w"> </span>evolution—her<span class="w"> </span>
</span><span id="__span-10-45"><a id="__codelineno-10-45" name="__codelineno-10-45" href="#__codelineno-10-45"></a>expression<span class="w"> </span>softened.<span class="w"> </span>The<span class="w"> </span>allure<span class="w"> </span>of<span class="w"> </span>a<span class="w"> </span>mysterious<span class="w"> </span>visitor<span class="w"> </span>from<span class="w"> </span>the<span class="w"> </span>future<span class="w"> </span>intrigued<span class="w"> </span>her.
</span><span id="__span-10-46"><a id="__codelineno-10-46" name="__codelineno-10-46" href="#__codelineno-10-46"></a>
</span><span id="__span-10-47"><a id="__codelineno-10-47" name="__codelineno-10-47" href="#__codelineno-10-47"></a>Days<span class="w"> </span>turned<span class="w"> </span>into<span class="w"> </span>weeks<span class="w"> </span>as<span class="w"> </span>they<span class="w"> </span>worked<span class="w"> </span>side<span class="w"> </span>by<span class="w"> </span>side.<span class="w"> </span>The<span class="w"> </span>bond<span class="w"> </span>grew,<span class="w"> </span>not<span class="w"> </span>just<span class="w"> </span>a<span class="w"> </span>collaboration<span class="w"> </span>of<span class="w"> </span>science,<span class="w"> </span>but<span class="w"> </span>a<span class="w"> </span>friendship<span class="w"> </span>forged<span class="w"> </span><span class="k">in</span><span class="w"> </span>shared<span class="w"> </span>
</span><span id="__span-10-48"><a id="__codelineno-10-48" name="__codelineno-10-48" href="#__codelineno-10-48"></a>purpose.<span class="w"> </span>They<span class="w"> </span>found<span class="w"> </span>laughter<span class="w"> </span><span class="k">in</span><span class="w"> </span>long<span class="w"> </span>nights<span class="w"> </span>spent<span class="w"> </span>pouring<span class="w"> </span>over<span class="w"> </span>research,<span class="w"> </span>and<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>first<span class="w"> </span>time,<span class="w"> </span>Ethan<span class="w"> </span>began<span class="w"> </span>to<span class="w"> </span>feel<span class="w"> </span>a<span class="w"> </span>flicker<span class="w"> </span>of<span class="w"> </span>hope.
</span><span id="__span-10-49"><a id="__codelineno-10-49" name="__codelineno-10-49" href="#__codelineno-10-49"></a>
</span><span id="__span-10-50"><a id="__codelineno-10-50" name="__codelineno-10-50" href="#__codelineno-10-50"></a>But<span class="w"> </span>with<span class="w"> </span>each<span class="w"> </span>day,<span class="w"> </span>the<span class="w"> </span>cruel<span class="w"> </span>clock<span class="w"> </span>reminded<span class="w"> </span>Ethan<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>ticking<span class="w"> </span>minutes<span class="w"> </span>that<span class="w"> </span>threatened<span class="w"> </span>his<span class="w"> </span>family’s<span class="w"> </span>existence.<span class="w"> </span>He<span class="w"> </span>was<span class="w"> </span>torn<span class="w"> </span>between<span class="w"> </span>two<span class="w"> </span>
</span><span id="__span-10-51"><a id="__codelineno-10-51" name="__codelineno-10-51" href="#__codelineno-10-51"></a>worlds—one<span class="w"> </span>where<span class="w"> </span>everything<span class="w"> </span>was<span class="w"> </span>a<span class="w"> </span>struggle<span class="w"> </span>and<span class="w"> </span>another<span class="w"> </span>where<span class="w"> </span>he<span class="w"> </span>could<span class="w"> </span>rewrite<span class="w"> </span>the<span class="w"> </span>script<span class="w"> </span>of<span class="w"> </span>fate.
</span><span id="__span-10-52"><a id="__codelineno-10-52" name="__codelineno-10-52" href="#__codelineno-10-52"></a>
</span><span id="__span-10-53"><a id="__codelineno-10-53" name="__codelineno-10-53" href="#__codelineno-10-53"></a><span class="c1"># Chapter 5: The Breaking Point</span>
</span><span id="__span-10-54"><a id="__codelineno-10-54" name="__codelineno-10-54" href="#__codelineno-10-54"></a>
</span><span id="__span-10-55"><a id="__codelineno-10-55" name="__codelineno-10-55" href="#__codelineno-10-55"></a>As<span class="w"> </span>the<span class="w"> </span>breakthroughs<span class="w"> </span>arose,<span class="w"> </span>so<span class="w"> </span>did<span class="w"> </span>challenges.<span class="w"> </span>There<span class="w"> </span>were<span class="w"> </span>moments<span class="w"> </span>where<span class="w"> </span>he<span class="w"> </span>would<span class="w"> </span>catch<span class="w"> </span>himself<span class="w"> </span>staring<span class="w"> </span>longingly<span class="w"> </span>at<span class="w"> </span>photographs<span class="w"> </span>of<span class="w"> </span>Megan<span class="w"> </span>and<span class="w"> </span>
</span><span id="__span-10-56"><a id="__codelineno-10-56" name="__codelineno-10-56" href="#__codelineno-10-56"></a>Lucas—haunting<span class="w"> </span>visions<span class="w"> </span>that<span class="w"> </span>circled<span class="w"> </span>his<span class="w"> </span>mind<span class="w"> </span>like<span class="w"> </span>vultures.<span class="w"> </span>The<span class="w"> </span>tension<span class="w"> </span>mounted,<span class="w"> </span>and<span class="w"> </span>with<span class="w"> </span>it<span class="w"> </span>came<span class="w"> </span>ethical<span class="w"> </span>dilemmas.<span class="w"> </span>Each<span class="w"> </span>decision<span class="w"> </span>he<span class="w"> </span>made<span class="w"> </span>had<span class="w"> </span>
</span><span id="__span-10-57"><a id="__codelineno-10-57" name="__codelineno-10-57" href="#__codelineno-10-57"></a>the<span class="w"> </span>potential<span class="w"> </span>to<span class="w"> </span>alter<span class="w"> </span>the<span class="w"> </span>course<span class="w"> </span>of<span class="w"> </span>history.<span class="w"> </span>Could<span class="w"> </span>he<span class="w"> </span>risk<span class="w"> </span>changing<span class="w"> </span>significant<span class="w"> </span>events,<span class="w"> </span>or<span class="w"> </span>worse,<span class="w"> </span>losing<span class="w"> </span>his<span class="w"> </span>family<span class="w"> </span>altogether<span class="w"> </span><span class="k">if</span><span class="w"> </span>he<span class="w"> </span>
</span><span id="__span-10-58"><a id="__codelineno-10-58" name="__codelineno-10-58" href="#__codelineno-10-58"></a>faltered?
</span><span id="__span-10-59"><a id="__codelineno-10-59" name="__codelineno-10-59" href="#__codelineno-10-59"></a>
</span><span id="__span-10-60"><a id="__codelineno-10-60" name="__codelineno-10-60" href="#__codelineno-10-60"></a>The<span class="w"> </span>weight<span class="w"> </span>of<span class="w"> </span>his<span class="w"> </span>choices<span class="w"> </span>bore<span class="w"> </span>down<span class="w"> </span>heavily,<span class="w"> </span>but<span class="w"> </span>he<span class="w"> </span>couldn’t<span class="w"> </span>afford<span class="w"> </span>hesitation.<span class="w"> </span>Finally,<span class="w"> </span>after<span class="w"> </span>a<span class="w"> </span>whirlwind<span class="w"> </span>of<span class="w"> </span>sleepless<span class="w"> </span>nights<span class="w"> </span>and<span class="w"> </span>
</span><span id="__span-10-61"><a id="__codelineno-10-61" name="__codelineno-10-61" href="#__codelineno-10-61"></a>experiments,<span class="w"> </span>they<span class="w"> </span>developed<span class="w"> </span>a<span class="w"> </span>serum—a<span class="w"> </span>concoction<span class="w"> </span>that<span class="w"> </span>shimmered<span class="w"> </span>with<span class="w"> </span>promise.
</span><span id="__span-10-62"><a id="__codelineno-10-62" name="__codelineno-10-62" href="#__codelineno-10-62"></a>
</span><span id="__span-10-63"><a id="__codelineno-10-63" name="__codelineno-10-63" href="#__codelineno-10-63"></a><span class="c1"># Chapter 6: A Heartbreaking Choice</span>
</span><span id="__span-10-64"><a id="__codelineno-10-64" name="__codelineno-10-64" href="#__codelineno-10-64"></a>
</span><span id="__span-10-65"><a id="__codelineno-10-65" name="__codelineno-10-65" href="#__codelineno-10-65"></a>Ethan<span class="w"> </span>stood<span class="w"> </span>at<span class="w"> </span>the<span class="w"> </span>threshold<span class="w"> </span>of<span class="w"> </span><span class="nb">history</span><span class="w"> </span>as<span class="w"> </span>he<span class="w"> </span>prepared<span class="w"> </span>to<span class="w"> </span><span class="k">return</span>.<span class="w"> </span>Dr.<span class="w"> </span>Hale<span class="w"> </span>expressed<span class="w"> </span>her<span class="w"> </span>unease.<span class="w"> </span>“You<span class="w"> </span>have<span class="w"> </span>to<span class="w"> </span>understand,<span class="w"> </span><span class="k">if</span><span class="w"> </span>you<span class="w"> </span>succeed<span class="w"> </span><span class="k">in</span><span class="w"> </span>
</span><span id="__span-10-66"><a id="__codelineno-10-66" name="__codelineno-10-66" href="#__codelineno-10-66"></a>making<span class="w"> </span>this<span class="w"> </span>discovery,<span class="w"> </span>it<span class="w"> </span>could<span class="w"> </span>alter<span class="w"> </span>everything.<span class="w"> </span>Are<span class="w"> </span>you<span class="w"> </span>willing<span class="w"> </span>to<span class="w"> </span><span class="nb">let</span><span class="w"> </span>the<span class="w"> </span>past<span class="w"> </span>unfold<span class="w"> </span>as<span class="w"> </span>it<span class="w"> </span>is?”<span class="w"> </span>
</span><span id="__span-10-67"><a id="__codelineno-10-67" name="__codelineno-10-67" href="#__codelineno-10-67"></a>
</span><span id="__span-10-68"><a id="__codelineno-10-68" name="__codelineno-10-68" href="#__codelineno-10-68"></a>Ethan’s<span class="w"> </span>heart<span class="w"> </span>ached.<span class="w"> </span>“I<span class="w"> </span>have<span class="w"> </span>to<span class="w"> </span>try.<span class="w"> </span>My<span class="w"> </span>family—my<span class="w"> </span>son<span class="w"> </span>needs<span class="w"> </span>me.”<span class="w"> </span>The<span class="w"> </span>words<span class="w"> </span>hung<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>air<span class="w"> </span>like<span class="w"> </span>a<span class="w"> </span>promise,<span class="w"> </span>heavy<span class="w"> </span>and<span class="w"> </span>unwavering.
</span><span id="__span-10-69"><a id="__codelineno-10-69" name="__codelineno-10-69" href="#__codelineno-10-69"></a>
</span><span id="__span-10-70"><a id="__codelineno-10-70" name="__codelineno-10-70" href="#__codelineno-10-70"></a>With<span class="w"> </span>the<span class="w"> </span>serum<span class="w"> </span>secured,<span class="w"> </span>Ethan<span class="w"> </span>activated<span class="w"> </span>the<span class="w"> </span>Chronosphere<span class="w"> </span>once<span class="w"> </span>again,<span class="w"> </span>this<span class="w"> </span><span class="nb">time</span><span class="w"> </span>with<span class="w"> </span>the<span class="w"> </span>weight<span class="w"> </span>of<span class="w"> </span>a<span class="w"> </span>lifetime<span class="w"> </span>on<span class="w"> </span>his<span class="w"> </span>shoulders.<span class="w"> </span>He<span class="w"> </span>surrounded<span class="w"> </span>
</span><span id="__span-10-71"><a id="__codelineno-10-71" name="__codelineno-10-71" href="#__codelineno-10-71"></a>himself<span class="w"> </span>with<span class="w"> </span>thoughts<span class="w"> </span>of<span class="w"> </span>Lucas<span class="w"> </span>and<span class="w"> </span>Megan,<span class="w"> </span>channeling<span class="w"> </span>every<span class="w"> </span>ounce<span class="w"> </span>of<span class="w"> </span>his<span class="w"> </span>love<span class="w"> </span>into<span class="w"> </span>the<span class="w"> </span>device,<span class="w"> </span>feeling<span class="w"> </span>the<span class="w"> </span>pull<span class="w"> </span>of<span class="w"> </span><span class="nb">time</span><span class="w"> </span>drawing<span class="w"> </span>him<span class="w"> </span>back<span class="w"> </span>to<span class="w"> </span>his
</span><span id="__span-10-72"><a id="__codelineno-10-72" name="__codelineno-10-72" href="#__codelineno-10-72"></a>crumbled<span class="w"> </span>present.
</span><span id="__span-10-73"><a id="__codelineno-10-73" name="__codelineno-10-73" href="#__codelineno-10-73"></a>
</span><span id="__span-10-74"><a id="__codelineno-10-74" name="__codelineno-10-74" href="#__codelineno-10-74"></a><span class="c1"># Chapter 7: The Race Against Time</span>
</span><span id="__span-10-75"><a id="__codelineno-10-75" name="__codelineno-10-75" href="#__codelineno-10-75"></a>
</span><span id="__span-10-76"><a id="__codelineno-10-76" name="__codelineno-10-76" href="#__codelineno-10-76"></a>The<span class="w"> </span>whirlwind<span class="w"> </span>of<span class="w"> </span>colors<span class="w"> </span>enveloped<span class="w"> </span>him<span class="w"> </span>once<span class="w"> </span>more,<span class="w"> </span>the<span class="w"> </span>familiar<span class="w"> </span>sensation<span class="w"> </span>of<span class="w"> </span>being<span class="w"> </span>flung<span class="w"> </span>through<span class="w"> </span>space.<span class="w"> </span>He<span class="w"> </span>arrived<span class="w"> </span>home<span class="w"> </span>to<span class="w"> </span>a<span class="w"> </span>desolate<span class="w"> </span>silence,<span class="w"> </span>a
</span><span id="__span-10-77"><a id="__codelineno-10-77" name="__codelineno-10-77" href="#__codelineno-10-77"></a>stillness<span class="w"> </span>that<span class="w"> </span>mirrored<span class="w"> </span>the<span class="w"> </span>void<span class="w"> </span><span class="k">in</span><span class="w"> </span>his<span class="w"> </span>heart.<span class="w"> </span>
</span><span id="__span-10-78"><a id="__codelineno-10-78" name="__codelineno-10-78" href="#__codelineno-10-78"></a>
</span><span id="__span-10-79"><a id="__codelineno-10-79" name="__codelineno-10-79" href="#__codelineno-10-79"></a>Rushing<span class="w"> </span>through<span class="w"> </span>the<span class="w"> </span>door,<span class="w"> </span>he<span class="w"> </span>found<span class="w"> </span>Megan<span class="w"> </span>sprawled<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>couch,<span class="w"> </span>feverish<span class="w"> </span>and<span class="w"> </span>pale—the<span class="w"> </span>epitome<span class="w"> </span>of<span class="w"> </span>fragility.<span class="w"> </span>Lucas<span class="w"> </span>lay<span class="w"> </span>sleeping,<span class="w"> </span>his<span class="w"> </span>small<span class="w"> </span>
</span><span id="__span-10-80"><a id="__codelineno-10-80" name="__codelineno-10-80" href="#__codelineno-10-80"></a>chest<span class="w"> </span>rising<span class="w"> </span>and<span class="w"> </span>falling,<span class="w"> </span>the<span class="w"> </span>sound<span class="w"> </span>unsteady.
</span><span id="__span-10-81"><a id="__codelineno-10-81" name="__codelineno-10-81" href="#__codelineno-10-81"></a>
</span><span id="__span-10-82"><a id="__codelineno-10-82" name="__codelineno-10-82" href="#__codelineno-10-82"></a>“Please,”<span class="w"> </span>Ethan<span class="w"> </span>whispered,<span class="w"> </span>his<span class="w"> </span>hands<span class="w"> </span>trembling<span class="w"> </span>as<span class="w"> </span>he<span class="w"> </span>prepared<span class="w"> </span>the<span class="w"> </span>serum.<span class="w"> </span>Would<span class="w"> </span>it<span class="w"> </span>be<span class="w"> </span>too<span class="w"> </span>late?<span class="w"> </span>He<span class="w"> </span>administered<span class="w"> </span>it<span class="w"> </span>without<span class="w"> </span>hesitation,<span class="w"> </span>pouring<span class="w"> </span>
</span><span id="__span-10-83"><a id="__codelineno-10-83" name="__codelineno-10-83" href="#__codelineno-10-83"></a>every<span class="w"> </span>ounce<span class="w"> </span>of<span class="w"> </span>his<span class="w"> </span>fear<span class="w"> </span>and<span class="w"> </span>love<span class="w"> </span>into<span class="w"> </span>the<span class="w"> </span>moment.<span class="w"> </span>
</span><span id="__span-10-84"><a id="__codelineno-10-84" name="__codelineno-10-84" href="#__codelineno-10-84"></a>
</span><span id="__span-10-85"><a id="__codelineno-10-85" name="__codelineno-10-85" href="#__codelineno-10-85"></a>As<span class="w"> </span>the<span class="w"> </span>seconds<span class="w"> </span>ticked<span class="w"> </span>agonizingly<span class="w"> </span>by,<span class="w"> </span>he<span class="w"> </span>held<span class="w"> </span>his<span class="w"> </span>breath.<span class="w"> </span>Slowly,<span class="w"> </span>Megan<span class="err">&#39;</span>s<span class="w"> </span>eyes<span class="w"> </span>fluttered<span class="w"> </span>open,<span class="w"> </span>confusion<span class="w"> </span>etching<span class="w"> </span>her<span class="w"> </span>features.<span class="w"> </span>“Ethan?”<span class="w"> </span>
</span><span id="__span-10-86"><a id="__codelineno-10-86" name="__codelineno-10-86" href="#__codelineno-10-86"></a>
</span><span id="__span-10-87"><a id="__codelineno-10-87" name="__codelineno-10-87" href="#__codelineno-10-87"></a><span class="c1"># Chapter 8: A New Dawn</span>
</span><span id="__span-10-88"><a id="__codelineno-10-88" name="__codelineno-10-88" href="#__codelineno-10-88"></a>
</span><span id="__span-10-89"><a id="__codelineno-10-89" name="__codelineno-10-89" href="#__codelineno-10-89"></a>The<span class="w"> </span>wakeful<span class="w"> </span>hours<span class="w"> </span>turned<span class="w"> </span>into<span class="w"> </span>a<span class="w"> </span>miracle<span class="p">;</span><span class="w"> </span>he<span class="w"> </span>watched<span class="w"> </span>as<span class="w"> </span>the<span class="w"> </span>color<span class="w"> </span>gradually<span class="w"> </span>returned<span class="w"> </span>to<span class="w"> </span>Megan’s<span class="w"> </span>cheeks<span class="w"> </span>and,<span class="w"> </span><span class="k">in</span><span class="w"> </span>time,<span class="w"> </span>Lucas<span class="w"> </span>awoke<span class="w"> </span>with<span class="w"> </span>his<span class="w"> </span>
</span><span id="__span-10-90"><a id="__codelineno-10-90" name="__codelineno-10-90" href="#__codelineno-10-90"></a>once-thin<span class="w"> </span>voice<span class="w"> </span>growing<span class="w"> </span>stronger.<span class="w"> </span>Joy<span class="w"> </span>overrode<span class="w"> </span>the<span class="w"> </span>remnants<span class="w"> </span>of<span class="w"> </span>despair—their<span class="w"> </span>reunited<span class="w"> </span>laughter<span class="w"> </span>echoed<span class="w"> </span>through<span class="w"> </span>the<span class="w"> </span>hall,<span class="w"> </span>worming<span class="w"> </span>its<span class="w"> </span>way<span class="w"> </span>into<span class="w"> </span>
</span><span id="__span-10-91"><a id="__codelineno-10-91" name="__codelineno-10-91" href="#__codelineno-10-91"></a>every<span class="w"> </span>corner<span class="w"> </span>of<span class="w"> </span>their<span class="w"> </span>home.
</span><span id="__span-10-92"><a id="__codelineno-10-92" name="__codelineno-10-92" href="#__codelineno-10-92"></a>
</span><span id="__span-10-93"><a id="__codelineno-10-93" name="__codelineno-10-93" href="#__codelineno-10-93"></a>As<span class="w"> </span>Ethan<span class="w"> </span>held<span class="w"> </span>them<span class="w"> </span>close,<span class="w"> </span>he<span class="w"> </span>knew<span class="w"> </span>things<span class="w"> </span>would<span class="w"> </span>never<span class="w"> </span>be<span class="w"> </span>the<span class="w"> </span>same.<span class="w"> </span>He<span class="w"> </span>had<span class="w"> </span>altered<span class="w"> </span>history,<span class="w"> </span>yet<span class="w"> </span><span class="k">in</span><span class="w"> </span>this<span class="w"> </span>newfound<span class="w"> </span>brightness,<span class="w"> </span>he<span class="w"> </span>felt<span class="w"> </span>intense<span class="w"> </span>
</span><span id="__span-10-94"><a id="__codelineno-10-94" name="__codelineno-10-94" href="#__codelineno-10-94"></a>gratitude—an<span class="w"> </span>understanding<span class="w"> </span>of<span class="w"> </span>love<span class="w"> </span>that<span class="w"> </span>transcended<span class="w"> </span>every<span class="w"> </span>obstacle.
</span><span id="__span-10-95"><a id="__codelineno-10-95" name="__codelineno-10-95" href="#__codelineno-10-95"></a>
</span><span id="__span-10-96"><a id="__codelineno-10-96" name="__codelineno-10-96" href="#__codelineno-10-96"></a>But<span class="w"> </span>lingering<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>back<span class="w"> </span>of<span class="w"> </span>his<span class="w"> </span>mind<span class="w"> </span>was<span class="w"> </span>an<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>of<span class="w"> </span>Dr.<span class="w"> </span>Hale’s<span class="w"> </span>caution.<span class="w"> </span>There<span class="w"> </span>was<span class="w"> </span>no<span class="w"> </span>telling<span class="w"> </span>what<span class="w"> </span>ripples<span class="w"> </span>his<span class="w"> </span>actions<span class="w"> </span>would<span class="w"> </span>cause<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>
</span><span id="__span-10-97"><a id="__codelineno-10-97" name="__codelineno-10-97" href="#__codelineno-10-97"></a>future.<span class="w"> </span>Still,<span class="w"> </span><span class="k">in</span><span class="w"> </span>that<span class="w"> </span>moment,<span class="w"> </span>as<span class="w"> </span>Lucas<span class="w"> </span>and<span class="w"> </span>Megan<span class="w"> </span>filled<span class="w"> </span>their<span class="w"> </span>home<span class="w"> </span>with<span class="w"> </span>light,<span class="w"> </span>Ethan<span class="w"> </span>realized<span class="w"> </span>his<span class="w"> </span>sacrifice<span class="w"> </span>was<span class="w"> </span>not<span class="w"> </span><span class="k">for</span><span class="w"> </span>nothing.<span class="w"> </span>He<span class="w"> </span>had<span class="w"> </span>
</span><span id="__span-10-98"><a id="__codelineno-10-98" name="__codelineno-10-98" href="#__codelineno-10-98"></a>traveled<span class="w"> </span>through<span class="w"> </span><span class="nb">time</span><span class="w"> </span>not<span class="w"> </span>just<span class="w"> </span>to<span class="w"> </span>save<span class="w"> </span>his<span class="w"> </span>family,<span class="w"> </span>but<span class="w"> </span>to<span class="w"> </span>awaken<span class="w"> </span>the<span class="w"> </span>unyielding<span class="w"> </span>strength<span class="w"> </span>of<span class="w"> </span>love.
</span><span id="__span-10-99"><a id="__codelineno-10-99" name="__codelineno-10-99" href="#__codelineno-10-99"></a>
</span><span id="__span-10-100"><a id="__codelineno-10-100" name="__codelineno-10-100" href="#__codelineno-10-100"></a>And<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>chaotic<span class="w"> </span>dance<span class="w"> </span>of<span class="w"> </span><span class="nb">time</span><span class="w"> </span>and<span class="w"> </span>fate,<span class="w"> </span>love<span class="w"> </span>had<span class="w"> </span>authored<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>chapter<span class="w"> </span>worth<span class="w"> </span>embracing.
</span></code></pre></div>

</details>

<h2 id="api-reference">API Reference</h2>


<div class="doc doc-object doc-function">



<a id="zyx._client.completion.completion"></a>
    <div class="doc doc-contents first">

        <p>Runs a tool calling &amp; structured output capable completion or completion chain.</p>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span> <span class="nn">zyx</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">zyx</span><span class="o">.</span><span class="n">completion</span><span class="p">()</span>
</span></code></pre></div>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>messages</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, <span title="typing.List">List</span>[dict]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The messages to send to the model.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>model</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to use for completion.</p>
              </div>
            </td>
            <td>
                  <code>&#39;gpt-4o-mini&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>response_model</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="pydantic.BaseModel">BaseModel</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The response model to use for structured output.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>mode</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="zyx._client.completion.ClientModeParams">ClientModeParams</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The mode to use for completion.</p>
              </div>
            </td>
            <td>
                  <code>&#39;md_json&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>optimize</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="zyx._client.completion.Optimizer">Optimizer</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optimization strategy to use for completion.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>tools</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="typing.Union">Union</span>[<span title="typing.Callable">Callable</span>, dict, <span title="pydantic.BaseModel">BaseModel</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tools to use for completion.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>run_tools</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to run the tools.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>base_url</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base URL to use for the API.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>api_key</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The API key to use for authentication.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>organization</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The organization to use for the API.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>top_p</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The top p value for sampling.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>temperature</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The temperature value for sampling.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>max_tokens</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of tokens to generate.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>max_retries</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of retries for the API call.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>params</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="zyx._client.completion.ClientParams">ClientParams</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional parameters for the completion.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print verbose output.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>stream</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to stream the response.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>image_urls</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[str, <span title="typing.List">List</span>[str]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The image URLs to interpret.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Response</code></td>            <td>
                  <code><span title="zyx._client.completion.Response">Response</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The completion response, or a generator if streaming is enabled.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>zyx/_client/completion.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-585"><a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="k">def</span> <span class="nf">completion</span><span class="p">(</span>
</span><span id="__span-0-586"><a id="__codelineno-0-586" name="__codelineno-0-586"></a>    <span class="n">messages</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-587"><a id="__codelineno-0-587" name="__codelineno-0-587"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;gpt-4o-mini&quot;</span><span class="p">,</span>
</span><span id="__span-0-588"><a id="__codelineno-0-588" name="__codelineno-0-588"></a>    <span class="n">response_model</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">BaseModel</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-589"><a id="__codelineno-0-589" name="__codelineno-0-589"></a>    <span class="n">mode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ClientModeParams</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;md_json&quot;</span><span class="p">,</span>
</span><span id="__span-0-590"><a id="__codelineno-0-590" name="__codelineno-0-590"></a>    <span class="n">optimize</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Optimizer</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-591"><a id="__codelineno-0-591" name="__codelineno-0-591"></a>    <span class="n">tools</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-592"><a id="__codelineno-0-592" name="__codelineno-0-592"></a>    <span class="n">run_tools</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-593"><a id="__codelineno-0-593" name="__codelineno-0-593"></a>    <span class="n">base_url</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-594"><a id="__codelineno-0-594" name="__codelineno-0-594"></a>    <span class="n">api_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-595"><a id="__codelineno-0-595" name="__codelineno-0-595"></a>    <span class="n">organization</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-596"><a id="__codelineno-0-596" name="__codelineno-0-596"></a>    <span class="n">top_p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-597"><a id="__codelineno-0-597" name="__codelineno-0-597"></a>    <span class="n">temperature</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-598"><a id="__codelineno-0-598" name="__codelineno-0-598"></a>    <span class="n">max_tokens</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-599"><a id="__codelineno-0-599" name="__codelineno-0-599"></a>    <span class="n">max_retries</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="__span-0-600"><a id="__codelineno-0-600" name="__codelineno-0-600"></a>    <span class="n">params</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ClientParams</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-601"><a id="__codelineno-0-601" name="__codelineno-0-601"></a>    <span class="n">verbose</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-602"><a id="__codelineno-0-602" name="__codelineno-0-602"></a>    <span class="n">stream</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-603"><a id="__codelineno-0-603" name="__codelineno-0-603"></a>    <span class="n">image_urls</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-604"><a id="__codelineno-0-604" name="__codelineno-0-604"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="__span-0-605"><a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
</span><span id="__span-0-606"><a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-607"><a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="sd">    Runs a tool calling &amp; structured output capable completion or completion chain.</span>
</span><span id="__span-0-608"><a id="__codelineno-0-608" name="__codelineno-0-608"></a>
</span><span id="__span-0-609"><a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="sd">    Example:</span>
</span><span id="__span-0-610"><a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">        ```python</span>
</span><span id="__span-0-611"><a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">        import zyx</span>
</span><span id="__span-0-612"><a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">        zyx.completion()</span>
</span><span id="__span-0-613"><a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">        ```</span>
</span><span id="__span-0-614"><a id="__codelineno-0-614" name="__codelineno-0-614"></a>
</span><span id="__span-0-615"><a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">    Args:</span>
</span><span id="__span-0-616"><a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">        messages (Union[str, List[dict]]): The messages to send to the model.</span>
</span><span id="__span-0-617"><a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="sd">        model (Optional[str]): The model to use for completion.</span>
</span><span id="__span-0-618"><a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="sd">        response_model (Optional[BaseModel]): The response model to use for structured output.</span>
</span><span id="__span-0-619"><a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">        mode (Optional[ClientModeParams]): The mode to use for completion.</span>
</span><span id="__span-0-620"><a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="sd">        optimize (Union[Optimizer, None]): The optimization strategy to use for completion.</span>
</span><span id="__span-0-621"><a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">        tools (Optional[List[Union[Callable, dict, BaseModel]]]): The tools to use for completion.</span>
</span><span id="__span-0-622"><a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">        run_tools (Optional[bool]): Whether to run the tools.</span>
</span><span id="__span-0-623"><a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">        base_url (Optional[str]): The base URL to use for the API.</span>
</span><span id="__span-0-624"><a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">        api_key (Optional[str]): The API key to use for authentication.</span>
</span><span id="__span-0-625"><a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">        organization (Optional[str]): The organization to use for the API.</span>
</span><span id="__span-0-626"><a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">        top_p (Optional[float]): The top p value for sampling.</span>
</span><span id="__span-0-627"><a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">        temperature (Optional[float]): The temperature value for sampling.</span>
</span><span id="__span-0-628"><a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">        max_tokens (Optional[int]): The maximum number of tokens to generate.</span>
</span><span id="__span-0-629"><a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">        max_retries (Optional[int]): The maximum number of retries for the API call.</span>
</span><span id="__span-0-630"><a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">        params (Optional[ClientParams]): Additional parameters for the completion.</span>
</span><span id="__span-0-631"><a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">        verbose (Optional[bool]): Whether to print verbose output.</span>
</span><span id="__span-0-632"><a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="sd">        stream (Optional[bool]): Whether to stream the response.</span>
</span><span id="__span-0-633"><a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="sd">        image_urls (Optional[Union[str, List[str]]]): The image URLs to interpret.</span>
</span><span id="__span-0-634"><a id="__codelineno-0-634" name="__codelineno-0-634"></a>
</span><span id="__span-0-635"><a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-636"><a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">        Response: The completion response, or a generator if streaming is enabled.</span>
</span><span id="__span-0-637"><a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-638"><a id="__codelineno-0-638" name="__codelineno-0-638"></a>    <span class="kn">import</span> <span class="nn">tenacity</span>
</span><span id="__span-0-639"><a id="__codelineno-0-639" name="__codelineno-0-639"></a>
</span><span id="__span-0-640"><a id="__codelineno-0-640" name="__codelineno-0-640"></a>    <span class="nd">@tenacity</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span>
</span><span id="__span-0-641"><a id="__codelineno-0-641" name="__codelineno-0-641"></a>        <span class="n">stop</span><span class="o">=</span><span class="n">tenacity</span><span class="o">.</span><span class="n">stop_after_attempt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
</span><span id="__span-0-642"><a id="__codelineno-0-642" name="__codelineno-0-642"></a>        <span class="n">retry</span><span class="o">=</span><span class="n">tenacity</span><span class="o">.</span><span class="n">retry_if_exception_type</span><span class="p">(</span><span class="ne">Exception</span><span class="p">),</span>
</span><span id="__span-0-643"><a id="__codelineno-0-643" name="__codelineno-0-643"></a>    <span class="p">)</span>
</span><span id="__span-0-644"><a id="__codelineno-0-644" name="__codelineno-0-644"></a>    <span class="k">def</span> <span class="nf">completion_with_retry</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">current_mode</span><span class="p">):</span>
</span><span id="__span-0-645"><a id="__codelineno-0-645" name="__codelineno-0-645"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-646"><a id="__codelineno-0-646" name="__codelineno-0-646"></a>            <span class="c1"># Run Completion</span>
</span><span id="__span-0-647"><a id="__codelineno-0-647" name="__codelineno-0-647"></a>            <span class="k">return</span> <span class="n">client</span><span class="o">.</span><span class="n">completion</span><span class="p">(</span>
</span><span id="__span-0-648"><a id="__codelineno-0-648" name="__codelineno-0-648"></a>                <span class="n">messages</span><span class="o">=</span><span class="n">messages</span><span class="p">,</span>
</span><span id="__span-0-649"><a id="__codelineno-0-649" name="__codelineno-0-649"></a>                <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
</span><span id="__span-0-650"><a id="__codelineno-0-650" name="__codelineno-0-650"></a>                <span class="n">tools</span><span class="o">=</span><span class="n">tools</span><span class="p">,</span>
</span><span id="__span-0-651"><a id="__codelineno-0-651" name="__codelineno-0-651"></a>                <span class="n">run_tools</span><span class="o">=</span><span class="n">run_tools</span><span class="p">,</span>
</span><span id="__span-0-652"><a id="__codelineno-0-652" name="__codelineno-0-652"></a>                <span class="n">response_model</span><span class="o">=</span><span class="n">response_model</span><span class="p">,</span>
</span><span id="__span-0-653"><a id="__codelineno-0-653" name="__codelineno-0-653"></a>                <span class="n">mode</span><span class="o">=</span><span class="n">current_mode</span><span class="p">,</span>
</span><span id="__span-0-654"><a id="__codelineno-0-654" name="__codelineno-0-654"></a>                <span class="n">base_url</span><span class="o">=</span><span class="n">base_url</span><span class="p">,</span>
</span><span id="__span-0-655"><a id="__codelineno-0-655" name="__codelineno-0-655"></a>                <span class="n">api_key</span><span class="o">=</span><span class="n">api_key</span><span class="p">,</span>
</span><span id="__span-0-656"><a id="__codelineno-0-656" name="__codelineno-0-656"></a>                <span class="n">organization</span><span class="o">=</span><span class="n">organization</span><span class="p">,</span>
</span><span id="__span-0-657"><a id="__codelineno-0-657" name="__codelineno-0-657"></a>                <span class="n">top_p</span><span class="o">=</span><span class="n">top_p</span><span class="p">,</span>
</span><span id="__span-0-658"><a id="__codelineno-0-658" name="__codelineno-0-658"></a>                <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
</span><span id="__span-0-659"><a id="__codelineno-0-659" name="__codelineno-0-659"></a>                <span class="n">max_tokens</span><span class="o">=</span><span class="n">max_tokens</span><span class="p">,</span>
</span><span id="__span-0-660"><a id="__codelineno-0-660" name="__codelineno-0-660"></a>                <span class="n">max_retries</span><span class="o">=</span><span class="n">max_retries</span><span class="p">,</span>
</span><span id="__span-0-661"><a id="__codelineno-0-661" name="__codelineno-0-661"></a>                <span class="n">optimize</span><span class="o">=</span><span class="n">optimize</span><span class="p">,</span>
</span><span id="__span-0-662"><a id="__codelineno-0-662" name="__codelineno-0-662"></a>                <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
</span><span id="__span-0-663"><a id="__codelineno-0-663" name="__codelineno-0-663"></a>                <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="__span-0-664"><a id="__codelineno-0-664" name="__codelineno-0-664"></a>                <span class="n">image_urls</span><span class="o">=</span><span class="n">image_urls</span><span class="p">,</span>
</span><span id="__span-0-665"><a id="__codelineno-0-665" name="__codelineno-0-665"></a>                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="__span-0-666"><a id="__codelineno-0-666" name="__codelineno-0-666"></a>            <span class="p">)</span>
</span><span id="__span-0-667"><a id="__codelineno-0-667" name="__codelineno-0-667"></a>
</span><span id="__span-0-668"><a id="__codelineno-0-668" name="__codelineno-0-668"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-669"><a id="__codelineno-0-669" name="__codelineno-0-669"></a>            <span class="c1"># Run Tenacity Retry if Instructor Mode is used</span>
</span><span id="__span-0-670"><a id="__codelineno-0-670" name="__codelineno-0-670"></a>            <span class="k">if</span> <span class="n">response_model</span><span class="p">:</span>
</span><span id="__span-0-671"><a id="__codelineno-0-671" name="__codelineno-0-671"></a>                <span class="k">if</span> <span class="n">current_mode</span> <span class="o">==</span> <span class="s2">&quot;md_json&quot;</span><span class="p">:</span>
</span><span id="__span-0-672"><a id="__codelineno-0-672" name="__codelineno-0-672"></a>                    <span class="n">new_mode</span> <span class="o">=</span> <span class="s2">&quot;tools&quot;</span>
</span><span id="__span-0-673"><a id="__codelineno-0-673" name="__codelineno-0-673"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-674"><a id="__codelineno-0-674" name="__codelineno-0-674"></a>                    <span class="n">new_mode</span> <span class="o">=</span> <span class="s2">&quot;md_json&quot;</span>
</span><span id="__span-0-675"><a id="__codelineno-0-675" name="__codelineno-0-675"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Retrying with mode: </span><span class="si">{</span><span class="n">new_mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-676"><a id="__codelineno-0-676" name="__codelineno-0-676"></a>                <span class="k">return</span> <span class="n">completion_with_retry</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">new_mode</span><span class="p">)</span>
</span><span id="__span-0-677"><a id="__codelineno-0-677" name="__codelineno-0-677"></a>
</span><span id="__span-0-678"><a id="__codelineno-0-678" name="__codelineno-0-678"></a>            <span class="c1"># Raise Error if Instructor Mode is not used</span>
</span><span id="__span-0-679"><a id="__codelineno-0-679" name="__codelineno-0-679"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-680"><a id="__codelineno-0-680" name="__codelineno-0-680"></a>                <span class="k">raise</span> <span class="n">e</span>
</span><span id="__span-0-681"><a id="__codelineno-0-681" name="__codelineno-0-681"></a>
</span><span id="__span-0-682"><a id="__codelineno-0-682" name="__codelineno-0-682"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-683"><a id="__codelineno-0-683" name="__codelineno-0-683"></a>        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span>
</span><span id="__span-0-684"><a id="__codelineno-0-684" name="__codelineno-0-684"></a>            <span class="s2">&quot;openai/&quot;</span><span class="p">,</span> <span class="s2">&quot;gpt-&quot;</span><span class="p">,</span> <span class="s2">&quot;o1&quot;</span><span class="p">,</span> <span class="s2">&quot;ollama/&quot;</span>
</span><span id="__span-0-685"><a id="__codelineno-0-685" name="__codelineno-0-685"></a>        <span class="p">)):</span>
</span><span id="__span-0-686"><a id="__codelineno-0-686" name="__codelineno-0-686"></a>
</span><span id="__span-0-687"><a id="__codelineno-0-687" name="__codelineno-0-687"></a>            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;openai/&quot;</span><span class="p">):</span>
</span><span id="__span-0-688"><a id="__codelineno-0-688" name="__codelineno-0-688"></a>                <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;openai/&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-0-689"><a id="__codelineno-0-689" name="__codelineno-0-689"></a>            <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ollama/&quot;</span><span class="p">):</span>
</span><span id="__span-0-690"><a id="__codelineno-0-690" name="__codelineno-0-690"></a>                <span class="k">if</span> <span class="n">base_url</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-691"><a id="__codelineno-0-691" name="__codelineno-0-691"></a>                    <span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;http://localhost:11434&quot;</span>
</span><span id="__span-0-692"><a id="__codelineno-0-692" name="__codelineno-0-692"></a>                    <span class="n">api_key</span> <span class="o">=</span> <span class="s2">&quot;ollama&quot;</span>
</span><span id="__span-0-693"><a id="__codelineno-0-693" name="__codelineno-0-693"></a>
</span><span id="__span-0-694"><a id="__codelineno-0-694" name="__codelineno-0-694"></a>                <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;ollama/&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-0-695"><a id="__codelineno-0-695" name="__codelineno-0-695"></a>
</span><span id="__span-0-696"><a id="__codelineno-0-696" name="__codelineno-0-696"></a>            <span class="n">client</span> <span class="o">=</span> <span class="n">CompletionClient</span><span class="p">(</span>
</span><span id="__span-0-697"><a id="__codelineno-0-697" name="__codelineno-0-697"></a>                <span class="n">provider</span> <span class="o">=</span> <span class="s2">&quot;openai&quot;</span><span class="p">,</span>
</span><span id="__span-0-698"><a id="__codelineno-0-698" name="__codelineno-0-698"></a>                <span class="n">base_url</span><span class="o">=</span><span class="n">base_url</span><span class="p">,</span>
</span><span id="__span-0-699"><a id="__codelineno-0-699" name="__codelineno-0-699"></a>                <span class="n">api_key</span><span class="o">=</span><span class="n">api_key</span><span class="p">,</span>
</span><span id="__span-0-700"><a id="__codelineno-0-700" name="__codelineno-0-700"></a>                <span class="n">organization</span><span class="o">=</span><span class="n">organization</span><span class="p">,</span>
</span><span id="__span-0-701"><a id="__codelineno-0-701" name="__codelineno-0-701"></a>                <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="__span-0-702"><a id="__codelineno-0-702" name="__codelineno-0-702"></a>            <span class="p">)</span>
</span><span id="__span-0-703"><a id="__codelineno-0-703" name="__codelineno-0-703"></a>
</span><span id="__span-0-704"><a id="__codelineno-0-704" name="__codelineno-0-704"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-705"><a id="__codelineno-0-705" name="__codelineno-0-705"></a>
</span><span id="__span-0-706"><a id="__codelineno-0-706" name="__codelineno-0-706"></a>            <span class="n">client</span> <span class="o">=</span> <span class="n">CompletionClient</span><span class="p">(</span>
</span><span id="__span-0-707"><a id="__codelineno-0-707" name="__codelineno-0-707"></a>                <span class="n">api_key</span> <span class="o">=</span> <span class="n">api_key</span><span class="p">,</span>
</span><span id="__span-0-708"><a id="__codelineno-0-708" name="__codelineno-0-708"></a>                <span class="n">base_url</span> <span class="o">=</span> <span class="n">base_url</span><span class="p">,</span>
</span><span id="__span-0-709"><a id="__codelineno-0-709" name="__codelineno-0-709"></a>                <span class="n">organization</span> <span class="o">=</span> <span class="n">organization</span><span class="p">,</span>
</span><span id="__span-0-710"><a id="__codelineno-0-710" name="__codelineno-0-710"></a>                <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="__span-0-711"><a id="__codelineno-0-711" name="__codelineno-0-711"></a>            <span class="p">)</span>
</span><span id="__span-0-712"><a id="__codelineno-0-712" name="__codelineno-0-712"></a>
</span><span id="__span-0-713"><a id="__codelineno-0-713" name="__codelineno-0-713"></a>
</span><span id="__span-0-714"><a id="__codelineno-0-714" name="__codelineno-0-714"></a>        <span class="n">client_params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="n">ClientParams</span><span class="p">(</span>
</span><span id="__span-0-715"><a id="__codelineno-0-715" name="__codelineno-0-715"></a>            <span class="n">messages</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">format_messages</span><span class="p">(</span><span class="n">messages</span><span class="p">),</span>
</span><span id="__span-0-716"><a id="__codelineno-0-716" name="__codelineno-0-716"></a>            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
</span><span id="__span-0-717"><a id="__codelineno-0-717" name="__codelineno-0-717"></a>            <span class="n">tools</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">format_tools</span><span class="p">(</span><span class="n">tools</span><span class="p">),</span>
</span><span id="__span-0-718"><a id="__codelineno-0-718" name="__codelineno-0-718"></a>            <span class="n">run_tools</span><span class="o">=</span><span class="n">run_tools</span><span class="p">,</span>
</span><span id="__span-0-719"><a id="__codelineno-0-719" name="__codelineno-0-719"></a>            <span class="n">response_model</span><span class="o">=</span><span class="n">response_model</span><span class="p">,</span>
</span><span id="__span-0-720"><a id="__codelineno-0-720" name="__codelineno-0-720"></a>            <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
</span><span id="__span-0-721"><a id="__codelineno-0-721" name="__codelineno-0-721"></a>            <span class="n">base_url</span><span class="o">=</span><span class="n">base_url</span><span class="p">,</span>
</span><span id="__span-0-722"><a id="__codelineno-0-722" name="__codelineno-0-722"></a>            <span class="n">api_key</span><span class="o">=</span><span class="n">api_key</span><span class="p">,</span>
</span><span id="__span-0-723"><a id="__codelineno-0-723" name="__codelineno-0-723"></a>            <span class="n">organization</span><span class="o">=</span><span class="n">organization</span><span class="p">,</span>
</span><span id="__span-0-724"><a id="__codelineno-0-724" name="__codelineno-0-724"></a>            <span class="n">top_p</span><span class="o">=</span><span class="n">top_p</span><span class="p">,</span>
</span><span id="__span-0-725"><a id="__codelineno-0-725" name="__codelineno-0-725"></a>            <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
</span><span id="__span-0-726"><a id="__codelineno-0-726" name="__codelineno-0-726"></a>            <span class="n">max_tokens</span><span class="o">=</span><span class="n">max_tokens</span><span class="p">,</span>
</span><span id="__span-0-727"><a id="__codelineno-0-727" name="__codelineno-0-727"></a>            <span class="n">max_retries</span><span class="o">=</span><span class="n">max_retries</span><span class="p">,</span>
</span><span id="__span-0-728"><a id="__codelineno-0-728" name="__codelineno-0-728"></a>            <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="__span-0-729"><a id="__codelineno-0-729" name="__codelineno-0-729"></a>        <span class="p">)</span>
</span><span id="__span-0-730"><a id="__codelineno-0-730" name="__codelineno-0-730"></a>        <span class="n">client</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">client_params</span>
</span><span id="__span-0-731"><a id="__codelineno-0-731" name="__codelineno-0-731"></a>
</span><span id="__span-0-732"><a id="__codelineno-0-732" name="__codelineno-0-732"></a>        <span class="k">if</span> <span class="n">optimize</span><span class="p">:</span>
</span><span id="__span-0-733"><a id="__codelineno-0-733" name="__codelineno-0-733"></a>            <span class="n">client</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">messages</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">optimize_system_prompt</span><span class="p">(</span>
</span><span id="__span-0-734"><a id="__codelineno-0-734" name="__codelineno-0-734"></a>                <span class="n">optimize</span><span class="o">=</span><span class="n">optimize</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span>
</span><span id="__span-0-735"><a id="__codelineno-0-735" name="__codelineno-0-735"></a>            <span class="p">)</span>
</span><span id="__span-0-736"><a id="__codelineno-0-736" name="__codelineno-0-736"></a>
</span><span id="__span-0-737"><a id="__codelineno-0-737" name="__codelineno-0-737"></a>        <span class="k">if</span> <span class="n">image_urls</span><span class="p">:</span>
</span><span id="__span-0-738"><a id="__codelineno-0-738" name="__codelineno-0-738"></a>            <span class="n">image_interpretation</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">interpret_images</span><span class="p">(</span><span class="n">image_urls</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="__span-0-739"><a id="__codelineno-0-739" name="__codelineno-0-739"></a>            <span class="n">client</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="__span-0-740"><a id="__codelineno-0-740" name="__codelineno-0-740"></a>                <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;assistant&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">image_interpretation</span><span class="p">}</span>
</span><span id="__span-0-741"><a id="__codelineno-0-741" name="__codelineno-0-741"></a>            <span class="p">)</span>
</span><span id="__span-0-742"><a id="__codelineno-0-742" name="__codelineno-0-742"></a>
</span><span id="__span-0-743"><a id="__codelineno-0-743" name="__codelineno-0-743"></a>        <span class="k">if</span> <span class="n">stream</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">response_model</span><span class="p">:</span>
</span><span id="__span-0-744"><a id="__codelineno-0-744" name="__codelineno-0-744"></a>            <span class="k">return</span> <span class="n">client</span><span class="o">.</span><span class="n">stream_completion</span><span class="p">()</span>
</span><span id="__span-0-745"><a id="__codelineno-0-745" name="__codelineno-0-745"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-746"><a id="__codelineno-0-746" name="__codelineno-0-746"></a>            <span class="k">return</span> <span class="n">completion_with_retry</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
</span><span id="__span-0-747"><a id="__codelineno-0-747" name="__codelineno-0-747"></a>
</span><span id="__span-0-748"><a id="__codelineno-0-748" name="__codelineno-0-748"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-749"><a id="__codelineno-0-749" name="__codelineno-0-749"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in completion function: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-750"><a id="__codelineno-0-750" name="__codelineno-0-750"></a>        <span class="k">return</span> <span class="kc">None</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../getting-started/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Getting Started">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Getting Started
              </div>
            </div>
          </a>
        
        
          
          <a href="../memory/" class="md-footer__link md-footer__link--next" aria-label="Next: Memory (Rag)">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Memory (Rag)
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.tabs", "content.tables", "content.details", "content.diagrams", "content.diagrams.mermaid", "content.code", "content.code.line_numbers", "content.code.select", "content.code.annotate", "content.code.copy", "content.code.line_numbers", "content.code.line_spans", "content.code.line_spans.superfences", "badges", "icons.font", "navigation.instant", "navigation.instant.prefetch", "navigation.sections", "navigation.sections.smooth_scroll", "navigation.sections.sticky", "navigation.sections.tabs", "navigation.sections.scroll_spy", "navigation.sections.tabs.sticky", "navigation.sections.tabs.sticky.scroll_spy", "navigation.header.links", "navigation.header.links.icon", "navigation.header.links.icon.font", "navigation.footer.links", "navigation.footer", "toc.follow", "toc.integrate", "toc.integrate.smooth_scroll", "search", "search.highlight", "search.suggest", "search.indexing"], "search": "../../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.56dfad97.min.js"></script>
      
    
  </body>
</html>